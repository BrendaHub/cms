<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.shishuo.cms.dao.CommentDao">
	<insert id="addComment" parameterType="com.shishuo.cms.entity.Comment">
		insert into `comment` (fileId,email,name,content,ip,fatherId,status,createTime,userId)
		 values (#{fileId},#{email},#{name},#{content},#{ip},#{fatherId},#{status},#{createTime},#{userId})
		<selectKey resultType="long" keyProperty="fileId">
			SELECT LAST_INSERT_ID()
		</selectKey>
	</insert>
	<select id="getCommentList" parameterType="long"  resultType="com.shishuo.cms.entity.Comment">
		select * from  `comment` where fileId = #{fileId} order by createTime desc
	</select>
	<select id="getChildCommentList"  parameterType="long" resultType="com.shishuo.cms.entity.Comment">
		select * from `comment` where fileId = #{fileId} and fatherId = #{fatherId} order by createTime desc
	</select>
	
	<update id="updateCommentStatus" parameterType="com.shishuo.cms.entity.Comment">
		update `comment` set status=#{status} where commentId=#{commentId}
	</update>
	
	<select id="getCommentById" parameterType="long"
		resultType="com.shishuo.cms.entity.Comment">
		select * from `comment` where commentId=#{commentId}
	</select>
	
	<select id="getAllList" parameterType="long"
		resultType="com.shishuo.cms.entity.vo.CommentVo">
		select * from `comment` limit #{offset},#{rows}
	</select>
	
	<select id="getAllListCount"
		resultType="Integer">
		select count(*) from `comment`
	</select>
	
	<select id="getCommentByStatusCount"
		resultType="com.shishuo.cms.entity.vo.CommentVo">
	</select>
</mapper>  